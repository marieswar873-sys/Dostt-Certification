<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DOSTT Certification</title>
  <meta name="viewport" content="width=1280">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body{margin:0;background:#f5f2fb;font-family:'Inter',Arial,sans-serif;}
    .header{background:#fff;padding:22px 32px 18px 32px;display:flex;align-items:center;gap:18px;box-shadow:0 2px 18px #c4b3e035;}
    .header img{height:60px;width:60px;object-fit:contain;border-radius:14px;background:#fff;}
    .header .title{font-size:2.15em;font-family:'Playfair Display',serif;font-weight:700;color:#783adf;}
    .header .tagline{font-size:1.10em;color:#46a7ea;font-weight:500;margin-top:6px;}
    .center-section{max-width:440px;margin:63px auto 0 auto;background:#fff;border-radius:22px;padding:44px 34px 40px 34px;box-shadow:0 14px 48px #bcb2de26;}
    label{font-weight:600;color:#7c53b5;font-size:1.11em;display:block;margin-bottom:9px;}
    input[type="text"],input[type="number"]{width:100%;padding:18px 17px;font-size:1.18em;border:2px solid #cfc9e9;border-radius:13px;background:#f8f7fd;color:#322665;margin-bottom:23px;box-sizing: border-box;}
    input[type="text"]:focus,input[type="number"]:focus{outline:2px solid #9246ec;border-color:#9246ec;}
    button.next-btn{width:100%;background:linear-gradient(94deg,#832ee6 0%,#24e09d 100%);color:#fff;font-size:1.22em;font-weight:700;padding:17px 0;border:none;border-radius:13px;cursor:pointer;box-shadow:0 2px 15px #af78ec1f;margin-top:15px;}
    button.next-btn:active{opacity:.89;}
    .info-note,.error-note{padding:12px 19px;border-radius:11px;margin-bottom:16px;font-size:1.05em;}
    .info-note{background:#f3edff;color:#8651be;}
    .error-note{background:#ffeaea;color:#dd4555;border:1.4px solid #ffc0c0;}
    h2{font-size:1.55em;font-weight:700;text-align:center;margin:0 0 23px 0;}
    .hide{display:none;}
    .otp-row{display:flex;gap:10px;}
    .otp-row button{width:auto;font-size:1.02em;padding:13px 22px;margin-top:0;}
  </style>
</head>
<body>
<div class="header">
  <img src="logo.png" alt="DOSTT Logo" onerror="this.onerror=null;this.src='https://via.placeholder.com/100x100?text=Logo';"/>
  <div>
    <div class="title">DOSTT Certification</div>
    <div class="tagline">Connections Begin Here</div>
  </div>
</div>
<div id="step1" class="center-section">
  <label for="name">Name</label>
  <input type="text" id="name" maxlength="40" placeholder="Full Name"/>
  <label for="mobile">Mobile Number (10 digits)</label>
  <input type="text" id="mobile" maxlength="10" placeholder="Enter 10 digit mobile"/>
  <button class="next-btn" id="btnStep1">Send OTP</button>
  <div id="infoStep1"></div>
</div>
<div id="step2" class="center-section hide">
  <label for="otp">Enter OTP</label>
  <div class="otp-row">
    <input type="text" id="otp" maxlength="6" placeholder="OTP (Check WhatsApp/SMS)" style="flex:2"/>
    <button id="btnResendOTP" type="button" style="background:#b893f9;">Resend OTP</button>
  </div>
  <button class="next-btn" id="btnStep2">Verify & Next</button>
  <div id="infoStep2" class="info-note"></div>
</div>

<script>
const OTP_API_URL = 'https://script.google.com/macros/s/AKfycbxEYsGuZ-1wRFjyNGWj60SV_-oIcb6nvaUfiCvWnDWNFHtv05otk0AADrAdSdMwQO-i7w/exec';

let recName="",mobile="";

function showStep(id) {
  Array.from(document.querySelectorAll('.center-section')).forEach(e=>e.classList.add('hide'));
  document.getElementById(id).classList.remove('hide');
}

document.getElementById("btnStep1").onclick = async function() {
  recName=document.getElementById('name').value.trim();
  mobile=document.getElementById('mobile').value.trim();
  let info = document.getElementById('infoStep1');
  info.className = 'info-note'; info.textContent = '';
  if (!recName) { info.textContent="Enter your name."; info.className='error-note'; return; }
  if(!/^\d{10}$/.test(mobile)){ info.textContent="Enter 10 digit mobile."; info.className='error-note'; return;}
  try{
    let resp=await fetch(OTP_API_URL + "?api=send-otp",{
      method:"POST",headers:{"Content-Type":"application/json"},
      body:JSON.stringify({phoneNumber:mobile})
    });
    let data=await resp.json();
    if(!data.success){ info.textContent=data.message||"OTP error"; info.className='error-note'; return;}
    info.textContent="OTP sent successfully. Enter it below."; info.className='info-note';
    setTimeout(()=>showStep("step2"),850);
  }catch(e){ info.textContent="Cannot send OTP. Check backend."; info.className='error-note'; }
};

document.getElementById("btnResendOTP").onclick = async function() {
  let info = document.getElementById('infoStep2');
  if(!/^\d{10}$/.test(mobile)){ info.textContent="Enter mobile above first."; info.className='error-note'; return;}
  try{
    let resp=await fetch(OTP_API_URL + "?api=send-otp",{
      method:"POST",headers:{"Content-Type":"application/json"},
      body:JSON.stringify({phoneNumber:mobile})
    });
    let data=await resp.json();
    if(!data.success){ info.textContent=data.message||"OTP resend error"; info.className='error-note'; return;}
    info.textContent="OTP resent successfully."; info.className='info-note';
  }catch(e){ info.textContent="Cannot resend OTP. Check backend."; info.className='error-note'; }
};

document.getElementById("btnStep2").onclick = async function() {
  let otpval=document.getElementById('otp').value.trim();
  let info=document.getElementById('infoStep2');
  if(!mobile || !/^\d{10}$/.test(mobile)){ info.textContent="Mobile missing. Go back and enter."; info.className='error-note'; return;}
  if(otpval.length<4){ info.textContent="Enter OTP sent to WhatsApp/SMS."; info.className='error-note'; return;}
  try{
    let resp=await fetch(OTP_API_URL + "?api=verify-otp",{
      method:"POST",headers:{"Content-Type":"application/json"},
      body:JSON.stringify({phoneNumber:mobile,otp:otpval})
    });
    let data=await resp.json();
    if(!data.success){info.textContent=data.message||'Invalid OTP';info.className='error-note';return;}
    info.textContent = "OTP verified! (Continue to next step)";
    info.className = 'info-note';
    // Next: show video/quiz/certificate
  }catch(e){ info.textContent="Cannot verify OTP. Check backend."; info.className='error-note'; }
};
</script>
</body>
</html>
